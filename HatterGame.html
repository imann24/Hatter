<!doctype html> 
<html lang="en"> 
<head> 
	<meta charset="UTF-8" />
	<title>Phaser - Making your first game, part 1</title>
	<script type="text/javascript" src= "js/phaser.min.js"></script>
    <script type="text/javascript" src= "GruntCode.js"></script>
    <script type="text/javascript" src= "PistolCode.js"></script>
    <script type="text/javascript" src= "PlayerCode.js"></script>
    <script type="text/javascript" src= "GUI.js"></script>
    <script type="text/javascript" src= "PreloadCode.js"></script>
    <script type="text/javascript" src= "CreateCode.js"></script>
    <script type="text/javascript" src= "EnvironmentCode.js"></script>
    <script type="text/javascript" src= "HealthCode.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
<script type="text/javascript">

var enemyAlive = true;
var enemy1;
var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });

function preload() {
    preloadSprites();
}


function create() {
    createGameItems();
}

function update() {
    bounceBulletPickUps();
    bounceHealthPickUps();

    for (var i = 0; i < enemies.length; i++) {
       // game.physics.overlap (enemies[i].sprite, bullets, enemies[i].damageEnemy, null, this);
       enemies[i].checkEnemyDamage();
    }
    
    game.physics.collide(player, platforms); 
    enemiesUpdate();

    if (playerGun.frame === 5 && fireCounter < 2 && firing === true) {
        fireCounter++;
    } else {
         playerGun.frame = 4;
         firing = false;
         fireCounter = 0;
    }
   
    resetPlayerMovement();

    if (cursors.left.isDown) {
        walkLeft();
    } else if (cursors.right.isDown) {
        walkRight();
        
    } else {
        playerStop();
    }
 
    //  Allow the player to jump if they are touching the ground.
    if (cursors.up.isDown && player.body.touching.down) {
        player.body.velocity.y = -500;  
    }

    if (cursors.down.isDown && player.body.touching.down === false) {
        player.body.velocity.y = 500;
    }
    if (fireKey.isDown) {
        pistolFire(player, playerGun, playerLeft, playerRight, ammoCount);
    }

    if (respawnKey.isDown) {
        respawnPlayer();
    }

    checkPlayerDamage();
    playerHealthMatch();
    
    pistolMatch(player, playerGun, playerLeft, playerRight);
    
    if (playerHealthNum < 1) {
        killPlayer();
    }
    checkBulletPickUp();  
    checkHealthPickUp(); 
    updateBullets();
    checkForWin();
}
</script>
</body>
</html>
